
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Neva timelapse</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <!-- Moving marker -->
    <script type="text/javascript" src="MovingMarker.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <script>

        // map
        var map = L.map('map')
            .setView([59.855668, 30.492981], 11);
        var basemap = L.tileLayer('https://tile.thunderforest.com/mobile-atlas/{z}/{x}/{y}.png?apikey=dc914d569c8e49dca90fe311a0be06fd', {
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://www.thunderforest.com/">ThunderForest</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);


  //      Load data
var data={points:{},path:{}};

//array for paths
var coords=[]
          $.ajax({
            type: "GET",
            url: "data/path.geojson",
            dataType: "json",
            success: function (response) {
                data.path = L.geoJson(response,{
                  onEachFeature: function(feature, layer) {
                  console.log('hey')
                  coords.push(layer.feature.geometry.coordinates);
                }  }
  ).addTo(map);

//swiping coordinates
  coords.forEach(function(entry) {
      entry.forEach(function(item) {
      var old =item[0];
      item[0]=item[1];
      item[1]=old});
});

            } });



            // $.ajax({
            // type: "GET",
            // url: "data/points84.geojson",
            // dataType: "json",
            // success: function (response) {
            //     data.points= L.geoJson(response,{
            //       onEachFeature: function(feature, layer) {
            //       console.log('hey')
            //
            //     }  });
            //     console.log('points');
            // map.fitBounds(data.path.getBounds())
            // } });


// MovingMarker
var line =[];
line.push([59.97474057373848,30.277994722334196 ])
line.push([ 59.96866901128213,30.290656050574988])
var myMovingMarker = L.Marker.movingMarker(line,[20000]).addTo(map);
var myMovingMarker = L.Marker.movingMarker(coords[0],[20000]).addTo(map);


myMovingMarker.start();


    </script>
</body>

</html>
